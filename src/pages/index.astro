---
import Layout from "../layouts/Layout.astro";

let resenas = [];

async function obtenerResenas() {
	const response = await fetch(
		"https://script.google.com/macros/s/AKfycbzTkO5VeaSI4TTozCV1Z3n_C3k-64_S13sB6d4hG5Iuz6fC9E-NUYbYnAocKRKrVB8K/exec",
	);

	if (!response.ok) {
		throw new Error("Error en la respuesta de la red");
	}

	resenas = await response.json();
}

await obtenerResenas();

function generarEstrellas(calificacion) {
	const maxEstrellas = 5;
	return "★".repeat(calificacion) + "☆".repeat(maxEstrellas - calificacion);
}
---

<Layout title="Welcome to Astro.">
	<div id="resenas" class="p-4 lg:p-20 grid grid-cols-1 md:grid-cols-2 gap-5 xl:grid-cols-6">
		{
			resenas.length === 0 ? (
				<p>No hay reseñas disponibles.</p>
			) : (
				resenas.map((resena) => (
					<div class="flex flex-col bg-white shadow-lg rounded-xl p-5">
						<strong>{resena.nombre}</strong>
						<p>{resena.comentario}</p>
						<p>Calificación: {generarEstrellas(resena.calificacion)}</p>
					</div>
				))
			)
		}
	</div>
</Layout>
